<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>

    <link rel="stylesheet" type="text/css" media="screen" href="css/materialize.css">
    <link rel="stylesheet" type="text/css" media="screen" href="css/materialize.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">

    <script src="jquery-3.2.1.min.js"></script>

    <script src="js/materialize.js"></script>
    <script src="js/materialize.min.js"></script>
</head>
<body>


            <nav>
                  <div class="nav-wrapper blue darken-1">
                    <a href="#!" class="brand-logo center">Thyssenkrupp</a>
                    </div>
                </nav>
                <br><br>

                <div class="row">
                  <div class="col m4 offset-m4  center">
                    <div class="card  white">
                      <div class="card-content white-text">
                      

                        <div class="col s12 ">
                            <select id='deptchoice' class="dropdown-trigger btn blue darken-1" >
                                <option value="" disabled selected style="color: white">Select Department</option>
                                <option value="sales">Sales Department</option>
                                <option value="HR Department">HR Department</option>
                                <option value="Warehouse Department">Warehouse Department</option>
                              </select>
                              <br><br>
                        </div>   
          
                          



                        



                          <div class="row">
                            
                            <div class="input-field col s11  blue-text">
                              <i class="material-icons prefix">assignment</i>
                              <input id="prfno" type="text" class="validate" placeholder="PRF Number">
                              
                            </div>


                    <div class="input-field col s6 offset-s3 center">
                            <button id="submit" class="btn waves-effect waves-light blue darken-1" id="checkprf" name="action">Submit
                                    <i class="material-icons right">send</i>
                                  </button>
                          </div>


                                
                          </div>
                          <div id="exist">
                            <center>
                              
                                
                              
                            </center>
                          </div>
                            
                            
                            

                                          


                        
                        <div class="row" >
                              <div class="row">
                                <div class="input-field col s6">
                                    <button id = 'groupcreation' class="btn waves-effect blue darken-1" type="submit" name="action">Create Group
                                        <i class="material-icons left">add_circle</i>
                                      </button> 
                                </div>
                                
                                <div class="input-field col s6" id="histbtn">
                                  <button class="btn waves-effect blue darken-1"  onclick="gethistory()">See History 
                                      <i class="material-icons left">history</i> 
                                    </button>
                                  
                                  </div>
                                
                              </div>
                          </div>
                          
                          <div class="row" >
                            <center>
                              <p style="color: green" id="creatinggrp"> Creating Group.... </p>
                              <p style="color: green" id="groupcreated"> Group Created Successfully </p>
                              <p style="color: red" id="groupnotcreated"> Unable to create group </p>
                            </center>
                          </div>
                        


                          
                        
                    
                      
                      </div>
                    
                    
                      
                    </div>
                  
                  </div>
                </div>
              

                <!-- Create Group -->

                








                <div class="row" id="newgroup">
                    <div class="col m4 offset-m4  center">
                      <div class="card  white">
                        <div class="card-content white-text">
                        
                          
      
                            <div class="col s6 " style="opacity: 0;">
                                <select disabled class="dropdown-trigger btn blue darken-1" >
                                    <option value="" disabled selected style="color: white">Designation</option>
                                    <option value="1">Sales Department</option>
                                    <option value="2">HR Department</option>
                                    <option value="3">Warehouse Department</option>
                                  </select>
                                  <br><br>
                            </div>

                            <div class="col s6 " style="opacity: 0">
                                <select disabled class="dropdown-trigger btn blue darken-1" >
                                    <option value="" disabled selected style="color: white">Designation</option>
                                    <option value="1">Sales Department</option>
                                    <option value="2">HR Department</option>
                                    <option value="3">Warehouse Department</option>
                                  </select>
                                  <br><br>
                            </div> 


                                    
    
    
                                        
                          
    
                                        <div class="row" id="emailcollection">
                                        <div class="input-field col s11  blue-text" >
                                                <i class="material-icons prefix">email</i>
                                                <input id="email" onfocus="addText(this)" type="text" class="validate" placeholder="Enter Email">
                                              </div>
    
                                        </div> 
    
                                        
                                    </div>
    
    
                          
    
    
                            
                            <div class="row">
                              
                                    
          
          
                            <div class="input-field col s6 offset-s3 center">
                                    <button  class="btn waves-effect waves-light blue darken-1" id="submitmail" >Submit Mail
                                            <i class="material-icons right">send</i>
                                          </button>
                                  </div>
          
          
                                        
                                  </div>
                          
                      
                        
                        </div>
                      
                      </div>
                    </div>
                     





                    <!-- end create group -->
      
                  
                  

  <script>

  var department
    var prfnumber
    var ctr = 0
    function addText(x)
    {
        ctr = ctr+1
        var str = 'email'+ctr
       
        var txt="<div class='row'><div class='input-field col s11  blue-text' ><i class='material-icons prefix'>email</i>  <input id='"+str+"' onfocus='addText(this)' type='text' class='validate' placeholder='Enter Email'></div></div>"
        $("#emailcollection").append(txt);
        
    }

  $(document).ready(function(){
    $('#histbtn').hide()
    $('#hide').hide()
    $('#hide2').hide()
    $('#Exist').hide();
    $('#groupcreated').hide()
    $('#groupnotcreated').hide()
    $('#creatinggrp').hide()

    

    
    $('#newgroup').hide();
    $('#notexist').hide();
    
    $('#groupcreation').click(function(){

      $('#newgroup').show(600);
    });
    

    //checking PRF Number
  
    $('#submit').click(function(){
      
       department = $('#deptchoice').val();
       prfnumber = $('#prfno').val();
      
      var data = {'deptchoice':department,'prfno':prfnumber}
                              console.log(data)

                                    
                              $.ajax({
                                    url : 'http://localhost/thyssenkrup/merging/hr.php',
                                    type : 'POST',
                                     data : {'deptchoice':department,'prfno':prfnumber},

                                     success : function(para){
                                
                                     
                                     if(para=='success')
                                     {
                                      $('#notexist').hide()
                                      var txt = '<b style="color: green" id="Exist">This PRF Number Already Exist</b>'
                                         
                                      
                                      
                                      
                                      $('#exist').append(txt)
                                      $('#histbtn').show()
                                     

                                     }
                                     else
                                     {
                                      $('#Exist').hide()
                                      var txt = '<b style="color: red" id="notexist">This PRF Number Does Not Exist</b> '
                                      $('#exist').append(txt)
                                     }
                                    
                        
                                    },

                                    error : function(err){
                                      
                                      
                                    }


                                  });
                            

          $('#notexist').fadeIn(600);


        });


  //submitting mails      


$('#submitmail').click(function(){
  $('#newgroup').hide(600);
  $('#creatinggrp').fadeIn(600)
  // alert($('#email').val())
    var arr = []
    arr[0]= $('#email').val()
    for(let i =1;i<ctr;i++)
    {
      var x = '#email'+i
     arr[i] = $(x).val()
      // alert(arr[i])
    }

    var data = {'emails':arr}

    $.ajax({
                                    url : '/demo.txt',
                                    type : 'GET',
                                    //dataType : 'json',
                                    //contentType : 'application/json',
                                    //data : JSON.stringify(data),
                                             
                                     success : function(para){
                                     para = 'created'
                                     if(para == 'created')
                                     {
                                      $('#creatinggrp').hide()
                                        $('#groupcreated').fadeIn(600)
                                     }
                                     else
                                     {
                                      $('#creatinggrp').hide()
                                      $('#groupnotcreated').fadeIn(600)
                                     }

                                     
                                     
                                    },

                                    error : function(err){
                                      
                                    }


                                  });

   });


  });


  //getting history

  function gethistory()
  {
    localStorage.setItem("department",department);
    localStorage.setItem("prf",prfnumber);
    document.location.replace('history.html')
    
    
  }
  
  </script>
                               
</body>
</html>